<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="../JavaScriptExamples/module/20200409-Myhelper.js"></script>
    <title>Document</title>
</head>

<body>
    <h1>Taiwan Address /Zip Code</h1>
    <button>Load ZipCode</button>

    <template id="template">
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </template>
    <div class="msg"></div>
    <script>
        let btn01 = $g('button');

        let msg = ('#msg');
        let xhr = new XMLHttpRequest;
        xhr.onload = function () {

            if (xhr.readyState == 4 && xhr.status == 200) {
                zipcodeArray = JSON.parse(this.responseText);

                console.log(zipcodeArray);//顯示抓到的資料

                let ZipCode = [];

                zipcodeArray.forEach((item, index) => {
                    // zipcodeArray.push({ City: "台北市", Districts: [{ District: "中正區", ZipCode: "100" }] });
                    // zipcodeArray.push({ City: "桃園市", Districts: [{ District: "桃園區", ZipCode: "330" }] });
                    // zipcodeArray.push({ City: "新竹市", Districts: [{ District: "竹北區", ZipCode: "300" }] });
                    // zipcodeArray.push({ City: "苗栗縣", Districts: [{ District: "後龍區", ZipCode: "330" }] });

                    let _city = item.CityName;
                    let _districts = [];

                    item.AreaList.forEach((item, index) => {
                        _districts.push({ District: item.AreaName, ZipCode: item.ZipCode });
                    });

                    let _cityObject = { City: _city, Districts: _districts };
                    ZipCode.push(_cityObject);



                });

                debugger;

            } else {
                msg.textContent = '發生錯誤，HTTP response代碼：' + xhr.status;
            }
            if (xhr.readyState == 4 && xhr.statusText == "OK") {
                msg.textContent = this.responseText;
            } else {
                msg.textContent = '發生錯誤，HTTP response代碼：' + xhr.status;
            }


        }
        xhr.open('GET', 'http://127.0.0.1:5500/JavaScript/JavaScriptExamples/20200409-TaiwanAddress.json');
        xhr.send();

    </script>
</body>

</html>